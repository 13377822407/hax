# ROS2 Stage1 æµ‹è¯•æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹æµ‹è¯•å‘å¸ƒ-è®¢é˜…åŠŸèƒ½

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨ç‹¬ç«‹è„šæœ¬ï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰

éœ€è¦å¼€å¯3ä¸ªç»ˆç«¯ï¼š

**ç»ˆç«¯1 - å¯åŠ¨å‘å¸ƒè€…ï¼š**
```bash
cd /home/hax/roslearn
./test_pub_sub.sh publisher
```

**ç»ˆç«¯2 - å¯åŠ¨è®¢é˜…è€…ï¼š**
```bash
cd /home/hax/roslearn
./test_pub_sub.sh subscriber
```

**é¢„æœŸè¾“å‡ºï¼š**

å‘å¸ƒè€…ï¼ˆæ¯500msï¼‰ï¼š
```
========== å¯åŠ¨å‘å¸ƒè€…èŠ‚ç‚¹ ==========
>>> å‘å¸ƒè€…å¯åŠ¨æˆåŠŸ
>>> æ¯500mså‘å¸ƒä¸€æ¡Twistæ¶ˆæ¯
>>> æŒ‰ Ctrl+C åœæ­¢

[INFO] é€Ÿåº¦å‘å¸ƒèŠ‚ç‚¹å·²å¯åŠ¨ï¼Œæ¯500mså‘å¸ƒä¸€æ¬¡é€Ÿåº¦å‘½ä»¤
[INFO] å‘å¸ƒè¯é¢˜: /cmd_vel
[INFO] å¼€å§‹è¿è¡Œï¼ŒæŒ‰Ctrl+Cåœæ­¢...
[INFO] [#1] å‘å¸ƒé€Ÿåº¦ -> linear.x: 0.50 m/s, angular.z: 0.20 rad/s
[INFO] [#2] å‘å¸ƒé€Ÿåº¦ -> linear.x: 0.50 m/s, angular.z: 0.20 rad/s
[INFO] [#3] å‘å¸ƒé€Ÿåº¦ -> linear.x: 0.50 m/s, angular.z: 0.20 rad/s
...
```

è®¢é˜…è€…ï¼ˆå®æ—¶æ¥æ”¶ï¼‰ï¼š
```
========== å¯åŠ¨è®¢é˜…è€…èŠ‚ç‚¹ ==========
>>> è®¢é˜…è€…å¯åŠ¨æˆåŠŸ
>>> ç›‘å¬ /cmd_vel è¯é¢˜
>>> æŒ‰ Ctrl+C åœæ­¢

========== æ¶ˆæ¯ #1 ==========
çº¿é€Ÿåº¦ (m/s):
  x (å‰å): 0.500
  y (å·¦å³): 0.000
  z (ä¸Šä¸‹): 0.000
  é€Ÿåº¦å¤§å°: 0.500
è§’é€Ÿåº¦ (rad/s):
  x (ç¿»æ»š): 0.000
  y (ä¿¯ä»°): 0.000
  z (è½¬å‘): 0.200
  è§’é€Ÿåº¦å¤§å°: 0.200
è¿åŠ¨çŠ¶æ€: å‰è¿› + å·¦è½¬
=====================================
```

---

### æ–¹æ¡ˆ2ï¼šè¿›å…¥å®¹å™¨æ‰‹åŠ¨è¿è¡Œï¼ˆæ›´çµæ´»ï¼‰

**ä¸€ä¸ªç»ˆç«¯ - å¯åŠ¨å®¹å™¨ï¼š**
```bash
cd /home/hax/roslearn
./ros_jazzy.sh
```

**å®¹å™¨å†… - ç»ˆç«¯A (å‘å¸ƒè€…)ï¼š**
```bash
ros2 run stage1_basic_control velocity_publisher
```

**å®¹å™¨å†… - ç»ˆç«¯B (è®¢é˜…è€…ï¼Œéœ€è¦åœ¨åŒä¸€å®¹å™¨å†…å†å¼€ç»ˆç«¯)ï¼š**
```bash
# åœ¨å®¹å™¨æ‰€åœ¨çš„å®¹å™¨IDä¸­å†å¼€ä¸€ä¸ªshellï¼ˆè¿™ç§æ–¹å¼è¾ƒå¤æ‚ï¼Œä¸æ¨èï¼‰
# æˆ–è€…æ‰“å¼€å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œ ./ros_jazzy.sh ç„¶åæ‰§è¡Œè®¢é˜…è€…
```

---

### æ–¹æ¡ˆ3ï¼šä½¿ç”¨Launchæ–‡ä»¶å¯åŠ¨å¤šä¸ªèŠ‚ç‚¹

```bash
cd /home/hax/roslearn
./ros_jazzy.sh
```

å®¹å™¨å†…ï¼š
```bash
# å¯åŠ¨å‘å¸ƒè€…å’Œè®¢é˜…è€…
ros2 launch stage1_basic_control basic_control.launch.py
```

**æ³¨æ„ï¼š** ç”±äºå®¹å™¨ç¯å¢ƒï¼ŒLaunchæ–‡ä»¶ä¸­çš„ `prefix='gnome-terminal --'` å¯èƒ½ä¸å·¥ä½œã€‚
å¦‚æœéœ€è¦è°ƒæ•´ï¼Œç¼–è¾‘ï¼š
```bash
vim /workspace/stage1_basic_control/launch/basic_control.launch.py
```

æ³¨é‡Šæ‰ç¬¬47è¡Œçš„ `prefix='gnome-terminal --',`

---

## ğŸ” éªŒè¯å‘å¸ƒ-è®¢é˜…é€šä¿¡

### æ–¹æ³•1ï¼šä½¿ç”¨ros2å·¥å…·æŸ¥çœ‹è¯é¢˜

**ï¼ˆéœ€è¦åœ¨å®¹å™¨å†…æˆ–å·²åŠ è½½ROS2ç¯å¢ƒï¼‰**

```bash
# åˆ—å‡ºæ‰€æœ‰è¯é¢˜
ros2 topic list

# æŸ¥çœ‹/cmd_velè¯é¢˜ä¿¡æ¯
ros2 topic info /cmd_vel

# ç›‘å¬/cmd_velè¯é¢˜çš„å®æ—¶æ•°æ®
ros2 topic echo /cmd_vel

# æŸ¥çœ‹å‘å¸ƒé¢‘ç‡
ros2 topic hz /cmd_vel

# è·å–è¯é¢˜æ¶ˆæ¯ç±»å‹
ros2 interface show geometry_msgs/msg/Twist
```

### æ–¹æ³•2ï¼šæŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯

```bash
# åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„èŠ‚ç‚¹
ros2 node list

# æŸ¥çœ‹velocity_publisherèŠ‚ç‚¹çš„è¯¦æƒ…
ros2 node info /velocity_publisher

# æŸ¥çœ‹velocity_subscriberèŠ‚ç‚¹çš„è¯¦æƒ…
ros2 node info /velocity_subscriber
```

### æ–¹æ³•3ï¼šä½¿ç”¨rqt_graphå¯è§†åŒ–

```bash
# åœ¨å®¹å™¨å†…ï¼ˆå¦‚æœé…ç½®äº†å›¾å½¢ç•Œé¢ï¼‰
apt-get install -y ros-jazzy-rqt-graph
rqt_graph
```

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯1ï¼šéªŒè¯å‘å¸ƒè€…æ­£å¸¸å·¥ä½œ

**åªå¯åŠ¨å‘å¸ƒè€…ï¼š**
```bash
./test_pub_sub.sh publisher
```

**é¢„æœŸï¼š** æ¯500msçœ‹åˆ°ä¸€æ¡å‘å¸ƒæ—¥å¿—

---

### åœºæ™¯2ï¼šéªŒè¯è®¢é˜…è€…æ­£å¸¸å·¥ä½œ

**å¯åŠ¨å‘å¸ƒè€…å’Œè®¢é˜…è€…ï¼š**
```bash
# ç»ˆç«¯1
./test_pub_sub.sh publisher

# ç»ˆç«¯2
./test_pub_sub.sh subscriber
```

**é¢„æœŸï¼š** è®¢é˜…è€…èƒ½å®æ—¶æ¥æ”¶å¹¶æ˜¾ç¤ºå‘å¸ƒè€…å‘é€çš„æ¶ˆæ¯

---

### åœºæ™¯3ï¼šéªŒè¯å¤šä¸ªè®¢é˜…è€…å¯ä»¥æ¥æ”¶åŒä¸€è¯é¢˜

**å¯åŠ¨1ä¸ªå‘å¸ƒè€…å’Œ2ä¸ªè®¢é˜…è€…ï¼š**
```bash
# ç»ˆç«¯1
./test_pub_sub.sh publisher

# ç»ˆç«¯2
./test_pub_sub.sh subscriber

# ç»ˆç«¯3
./test_pub_sub.sh subscriber
```

**é¢„æœŸï¼š** ä¸¤ä¸ªè®¢é˜…è€…éƒ½èƒ½æ¥æ”¶åˆ°æ¶ˆæ¯

---

## ğŸ“Š è¾“å‡ºæ•°æ®è¯´æ˜

### Twistæ¶ˆæ¯ç»“æ„

```
geometry_msgs/msg/Twist {
  linear:   # çº¿é€Ÿåº¦ (m/s)
    x: 0.5    # å‰è¿›é€Ÿåº¦
    y: 0.0    # å·¦å³é€Ÿåº¦
    z: 0.0    # ä¸Šä¸‹é€Ÿåº¦
  angular:  # è§’é€Ÿåº¦ (rad/s)
    x: 0.0    # ç¿»æ»šé€Ÿåº¦
    y: 0.0    # ä¿¯ä»°é€Ÿåº¦
    z: 0.2    # è½¬å‘é€Ÿåº¦
}
```

### è¿åŠ¨çŠ¶æ€è§£æ

- `linear.x > 0`: å‰è¿›
- `linear.x < 0`: åé€€
- `angular.z > 0`: å·¦è½¬
- `angular.z < 0`: å³è½¬
- é€Ÿåº¦å¤§å° = âˆš(xÂ² + yÂ² + zÂ²)

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: "docker not found" é”™è¯¯

**åŸå› ï¼š** Dockeræœªå®‰è£…æˆ–æœªåœ¨PATHä¸­

**è§£å†³ï¼š** ç¡®ä¿Dockerå·²å®‰è£…å¹¶è¿è¡Œ
```bash
docker --version
sudo systemctl start docker
```

### Q2: å®¹å™¨å¯åŠ¨å¾ˆæ…¢

**åŸå› ï¼š** é¦–æ¬¡å¯åŠ¨éœ€è¦ä¸‹è½½é•œåƒæˆ–ç¼–è¯‘

**è§£å†³ï¼š** ç­‰å¾…ï¼Œä½¿ç”¨ `docker images` æ£€æŸ¥é•œåƒæ˜¯å¦å·²ä¸‹è½½

### Q3: æƒé™é”™è¯¯

**åŸå› ï¼š** ç”¨æˆ·ä¸åœ¨dockerç»„

**è§£å†³ï¼š**
```bash
sudo usermod -a -G docker $USER
# æ³¨é”€å¹¶é‡æ–°ç™»å½•
```

### Q4: æ— æ³•é€šä¿¡ï¼ˆå‘å¸ƒè€…å’Œè®¢é˜…è€…çœ‹ä¸åˆ°å½¼æ­¤ï¼‰

**åŸå› ï¼š** 
- å®¹å™¨ç½‘ç»œé…ç½®é—®é¢˜
- è¯é¢˜åç§°ä¸ä¸€è‡´

**è°ƒè¯•ï¼š**
```bash
# æŸ¥çœ‹å‘å¸ƒè€…å’Œè®¢é˜…è€…æ˜¯å¦åœ¨åŒä¸€ç½‘ç»œ
docker network inspect host

# æ‰‹åŠ¨å‘å¸ƒæ¶ˆæ¯æµ‹è¯•
ros2 topic pub /cmd_vel geometry_msgs/msg/Twist "{linear: {x: 1.0}, angular: {z: 0.5}}"
```

---

## ğŸ“š æ‰©å±•å­¦ä¹ 

å®ŒæˆåŸºæœ¬æµ‹è¯•åï¼Œå¯ä»¥å°è¯•ï¼š

1. **ä¿®æ”¹å‘å¸ƒé¢‘ç‡**
   - ç¼–è¾‘ `src/velocity_publisher.cpp`
   - ä¿®æ”¹å®šæ—¶å™¨æ—¶é—´ï¼ˆç›®å‰æ˜¯500msï¼‰

2. **ä¿®æ”¹é€Ÿåº¦å‚æ•°**
   - åœ¨ `timer_callback()` ä¸­ä¿®æ”¹ `msg.linear.x` å’Œ `msg.angular.z` çš„å€¼

3. **æ·»åŠ æ›´å¤šè®¢é˜…è€…**
   - åˆ›å»ºæ–°çš„C++æ–‡ä»¶ï¼Œç¼–å†™è‡ªå·±çš„è®¢é˜…é€»è¾‘

4. **ä½¿ç”¨é”®ç›˜æ§åˆ¶**
   - å¯åŠ¨ teleop_keyboard èŠ‚ç‚¹
   - ç”¨é”®ç›˜å®æ—¶æ§åˆ¶é€Ÿåº¦

---

## âœ… å®Œæ•´æµ‹è¯•æ¸…å•

- [ ] ç¼–è¯‘ stage1_basic_control åŒ…
- [ ] å¯åŠ¨å‘å¸ƒè€…ï¼ŒæŸ¥çœ‹æ—¥å¿—è¾“å‡º
- [ ] å¯åŠ¨è®¢é˜…è€…ï¼ŒéªŒè¯æ¥æ”¶æ¶ˆæ¯
- [ ] ä½¿ç”¨ `ros2 topic list` æŸ¥çœ‹è¯é¢˜
- [ ] ä½¿ç”¨ `ros2 topic echo` ç›‘å¬æ•°æ®
- [ ] ä¿®æ”¹ä»£ç å¹¶é‡æ–°ç¼–è¯‘
- [ ] å¯åŠ¨é”®ç›˜æ§åˆ¶èŠ‚ç‚¹
- [ ] ç†è§£ROS2é€šä¿¡æ¨¡å¼

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼å¦‚æœ‰é—®é¢˜ï¼ŒæŸ¥é˜… TROUBLESHOOTING.md**
