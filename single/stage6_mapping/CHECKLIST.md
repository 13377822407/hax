# Stage 6 学习检查清单

## 📋 知识点掌握检查

### 🔰 基础概念（必须掌握）

- [ ] **什么是占据栅格地图？**
  - [ ] 理解栅格地图是世界的"像素化"表示
  - [ ] 知道三种格子状态：free (0), occupied (100), unknown (-1)
  - [ ] 理解分辨率 (resolution) 的含义

- [ ] **为什么需要建图？**
  - [ ] 理解地图是导航的基础
  - [ ] 知道建图和SLAM的区别
  - [ ] 了解占据栅格地图的应用场景

- [ ] **坐标系关系**
  - [ ] 理解 map, odom, base_link 三个坐标系
  - [ ] 知道为什么需要坐标变换
  - [ ] 能解释刚体变换（旋转+平移）

### ⚙️ 核心算法（重点理解）

- [ ] **坐标变换公式**
  - [ ] 能写出从机器人坐标系到地图坐标系的变换公式
  - [ ] 理解为什么需要 sin/cos 旋转
  - [ ] 知道世界坐标如何转换为栅格索引

- [ ] **射线跟踪（Bresenham）**
  - [ ] 理解为什么要标记射线路径为 free
  - [ ] 知道 Bresenham 算法的作用
  - [ ] 能解释障碍物端点为什么标记为 occupied

- [ ] **概率更新**
  - [ ] 理解简化版本（直接覆盖）的局限性
  - [ ] 了解 log-odds 累积的优势
  - [ ] 知道专业 SLAM 如何处理不确定性

### 💻 实践操作（动手能力）

- [ ] **编译和运行**
  - [ ] 成功编译 stage6_mapping 包
  - [ ] 能启动映射节点
  - [ ] 能在 RViz 中看到地图

- [ ] **RViz 配置**
  - [ ] 知道如何设置 Fixed Frame 为 map
  - [ ] 能添加 Map 显示项
  - [ ] 能同时显示激光、里程计和地图

- [ ] **参数调整**
  - [ ] 能修改地图大小和分辨率
  - [ ] 知道如何调整 origin 让机器人在中心
  - [ ] 会切换到融合后的里程计

### 🔍 问题诊断（故障排查）

- [ ] **常见问题**
  - [ ] 知道 RViz 看不到地图时如何排查
  - [ ] 能判断地图扭曲的原因（里程计误差）
  - [ ] 会检查话题和 TF 树

- [ ] **性能优化**
  - [ ] 理解为什么慢速移动效果更好
  - [ ] 知道使用融合里程计的好处
  - [ ] 了解下采样激光的方法

## 🎯 实践任务完成度

### 任务 1：基础运行（必做）
- [ ] 启动映射器并成功建图
- [ ] 在 RViz 中观察实时地图生成
- [ ] 保存地图文件并用图片查看器打开

### 任务 2：参数实验（推荐）
- [ ] 尝试 3 种不同的分辨率（0.05, 0.1, 0.2）
- [ ] 对比不同地图大小的效果
- [ ] 测试使用 /odom vs /odometry/filtered

### 任务 3：代码理解（进阶）
- [ ] 阅读 simple_mapper.cpp 并理解每个函数
- [ ] 找到坐标变换的代码行
- [ ] 找到 Bresenham 算法的实现

### 任务 4：扩展开发（高级）
- [ ] 实现地图覆盖率统计（已在增强版中实现）
- [ ] 尝试添加 log-odds 概率更新
- [ ] 对比本包和 slam_toolbox 的建图效果

## 📚 理论知识深化

### 数学基础
- [ ] 理解 2D 旋转矩阵
  ```
  [cos(θ)  -sin(θ)]   [x]
  [sin(θ)   cos(θ)] × [y]
  ```

- [ ] 理解齐次坐标变换
  ```
  [x']   [R  t]   [x]
  [y'] = [0  1] × [y]
  [1 ]             [1]
  ```

### 算法原理
- [ ] 理解占据概率的贝叶斯更新
  ```
  P(m|z) = [P(z|m) × P(m)] / P(z)
  ```

- [ ] 了解 log-odds 表示
  ```
  l(m) = log[P(m) / (1 - P(m))]
  ```

### ROS 概念
- [ ] 理解 QoS (Quality of Service) 策略
- [ ] 知道 transient_local 的作用
- [ ] 理解 SensorDataQoS 的含义

## 🎓 学习成果验证

### 自我评估问题

**Q1: 如果机器人在 (5, 3) 位置，朝向 90°（正北），激光测到前方 2米处有障碍物，障碍物在地图中的坐标是多少？**
<details>
<summary>点击查看答案</summary>

```
机器人：(5, 3, 90°)
激光端点（机器人坐标系）：(2, 0)  # 前方2米

变换：
yaw = 90° = π/2
global_x = 5 + 2*cos(π/2) - 0*sin(π/2) = 5 + 0 = 5
global_y = 3 + 2*sin(π/2) + 0*cos(π/2) = 3 + 2 = 5

答案：(5, 5)
```
</details>

**Q2: 为什么地图会出现重影？如何解决？**
<details>
<summary>点击查看答案</summary>

原因：
1. 里程计漂移（位置误差累积）
2. 运动畸变（激光扫描期间机器人移动）
3. 时间戳不同步

解决方案：
1. 使用融合里程计（EKF 结合 IMU）
2. 降低机器人移动速度
3. 使用真正的 SLAM（slam_toolbox）进行闭环优化
</details>

**Q3: Bresenham 算法相比浮点插值有什么优势？**
<details>
<summary>点击查看答案</summary>

优势：
1. 只用整数运算，速度快
2. 不需要浮点除法和取整
3. 保证线条连续，不会遗漏格子
4. 适合实时系统

劣势：
- 对于非常长的线可能有微小误差
</details>

## ✅ 完成标准

### 基础级别（60分）
- ✓ 成功运行映射节点
- ✓ 能在 RViz 中看到地图
- ✓ 理解占据栅格的基本概念

### 熟练级别（80分）
- ✓ 能调整参数优化地图效果
- ✓ 理解坐标变换和射线跟踪原理
- ✓ 能诊断常见问题

### 精通级别（100分）
- ✓ 能修改代码实现新功能
- ✓ 理解建图和SLAM的本质区别
- ✓ 能独立设计建图方案

## 📝 学习笔记模板

```markdown
# Stage 6 学习笔记

## 日期：________

### 今天学到了什么？
- 

### 遇到了什么问题？
- 

### 如何解决的？
- 

### 仍然不理解的地方：
- 

### 下次要尝试的：
- 
```

## 🎯 下一步学习建议

根据你的完成情况：

**如果基础任务都完成了 →** 可以进入 Stage 7 学习 SLAM

**如果还有疑问 →** 重新阅读 README，运行更多实验

**如果想深入研究 →** 尝试进阶练习，阅读相关论文

---

**记住**：建图是机器人导航的基础，理解本章内容对后续学习至关重要！

**建议学习时间**：
- 基础理解：2-3 小时
- 动手实践：3-4 小时
- 深入研究：5+ 小时
